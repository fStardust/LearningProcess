def job2(name):
    # 具体要执行的代码
    # com_weather()
    localtime = datetime.now()
    print(localtime.strftime("%Y-%m-%d %H:%M:%S"))
    print('{} 任务运行成功！{}'.format(name, time.strftime("%Y-%m-%d %H:%M:%S")))


scheduler = BackgroundScheduler()
scheduler.add_jobstore(DjangoJobStore(), "default")

scheduler.add_job(job2, "interval", seconds=10, args=['王飞'], id="job2")

scheduler.start()  # 开始执行调度器



# 修改定时提醒时间
def com_timer(request, daily):

    daily_time = daily # 数据库查取
    if request.method == 'POST':
        daily_time_hour = request.POST['daily_time_hour']
        daily_time_min = request.POST['daily_time_min']
        daily_time_per = daily_time_hour + ":" + daily_time_min

        daily_time = pd.to_datetime(daily_time_per, format="%H:%M", errors="coerce")

        print(daily_time)

    ThreadingTimer().start()

    context = {
        'daily_time': daily_time,
    }

    return render(request, template_name='timer.html', context=context)
